<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Read a Heidelberg format (.fh) tree-ring file — read_fh • fellingdater</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Read a Heidelberg format (.fh) tree-ring file — read_fh"><meta name="description" content="This function reads a Heidelberg format file (.fh) containing
ring width data and returns the HEADER fields as attributes of the
data.frame´with the measurement data.
The Heidelberg file format is described in detail here:
https://www.treeringsociety.org/resources/SOM/Brewer_Murphy_SupplementaryMaterial.pdf"><meta property="og:description" content="This function reads a Heidelberg format file (.fh) containing
ring width data and returns the HEADER fields as attributes of the
data.frame´with the measurement data.
The Heidelberg file format is described in detail here:
https://www.treeringsociety.org/resources/SOM/Brewer_Murphy_SupplementaryMaterial.pdf"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fellingdater</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/getting_started.html">Get started</a></li>
    <li><a class="dropdown-item" href="../articles/the_workflow.html">The ´fellingdater´ workflow</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/fellingdater/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Read a Heidelberg format (.fh) tree-ring file</h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/fellingdater/blob/main/R/read_fh.R" class="external-link"><code>R/read_fh.R</code></a></small>
      <div class="d-none name"><code>read_fh.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function reads a Heidelberg format file (.fh) containing
ring width data and returns the HEADER fields as attributes of the
<code>data.frame</code>´with the measurement data.</p>
<p>The Heidelberg file format is described in detail here:
https://www.treeringsociety.org/resources/SOM/Brewer_Murphy_SupplementaryMaterial.pdf</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">read_fh</span><span class="op">(</span><span class="va">fname</span>, BC_correction <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fname">fname<a class="anchor" aria-label="anchor" href="#arg-fname"></a></dt>
<dd><p>A <code>character</code> vector specifying the name of the .fh file to
read.</p></dd>


<dt id="arg-bc-correction">BC_correction<a class="anchor" aria-label="anchor" href="#arg-bc-correction"></a></dt>
<dd><p>A <code>logical</code>. If <code>TRUE</code> the correction moves BC-dates one
year forward.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A <code>logical</code>. If <code>FALSE</code>, messages are suppressed during the
reading process.</p></dd>


<dt id="arg-header">header<a class="anchor" aria-label="anchor" href="#arg-header"></a></dt>
<dd><p>A <code>logical</code>. If <code>TRUE</code> the HEADER fields are returned as a
<code>data.frame</code>; if <code>FALSE</code>, the measurement data is returned.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>header</code> is TRUE, a data.frame is returned with HEADER fields as
attributes. If <code>header</code> is FALSE, a <code>data.frame</code> of class <code>rwl</code> with
ring-width measurements in columns is returned, with (calendar) years as
row names.`</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function reads .fh file with ring width data in either block
(decadal format) or column format (e.g., with comment flags) as used by
TSAP program. The function is also capable of reading chronologies or
half-chronos in decadal format. The <code>read_fh</code> function is case-insensitive.
Information found in the HEADER fields is listed as attributes of the
<code>data.frame</code>´with the measurement data. .</p>
<p>The header fields harvested from the .fh file include:</p>
<p>"Project", "FirstMeasurementDate", "Location", "Town", "Street", "Client",
"Longitude", "Latitude", "DateOfSampling", "FirstMeasurementDate",
"SapWoodRings", "Comment", "MissingRingsAfter", "InvalidRingsAfter",
"MissingringsBefore", "DeltaMissingringsBefore", "ChronoMemberKeycodes",
"PersId"</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>This function is an extension of <code>read.fh()</code> from the <strong>dplR
package</strong> (<a href="https://github.com/opendendro/dplR" class="external-link">https://github.com/opendendro/dplR</a>), developed and maintained
by Prof. dr. Andy Bunn (Bunn 2008, Bunn 2010, Bunn et al. 2022) on
<a href="https://opendendro.org/" class="external-link">https://opendendro.org/</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>The original <code>read.fh()</code> function is part of the <strong>dplR package</strong>
(<a href="https://github.com/opendendro/dplR" class="external-link">https://github.com/opendendro/dplR</a>) and was developed by Christian Zang,
with new features and patches contributed by Mikko Korpela and Ronald
Visser. This <code>read_fh()</code> function expands the functionalities of the
original <code><a href="https://rdrr.io/pkg/dplR/man/read.fh.html" class="external-link">dplR::read.fh()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">Doel1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"DOEL1.fh"</span>, package <span class="op">=</span> <span class="st">"fellingdater"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Doel1_trs</span> <span class="op">&lt;-</span> <span class="fu">read_fh</span><span class="op">(</span><span class="va">Doel1</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Doel1_trs</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      K1_091 S38-BB GD3-1BB GR1mBB GQ1mBB K1_095 GG1-1BB S13mSB S13A-BB S6-SB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1150     NA     NA      NA     NA   3.80     NA      NA     NA      NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1151     NA     NA      NA     NA   4.15     NA      NA     NA      NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1152     NA     NA      NA     NA   4.63     NA      NA     NA      NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1153     NA     NA      NA     NA   4.31     NA      NA     NA      NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1154     NA     NA      NA     NA   3.97     NA      NA     NA      NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1155     NA     NA      NA     NA   4.10     NA      NA     NA      NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1156     NA     NA      NA     NA   2.02     NA      NA     NA      NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1157     NA     NA      NA     NA   3.24     NA      NA     NA      NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1158   2.50     NA      NA     NA   3.75     NA      NA     NA      NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1159   2.73     NA      NA     NA   3.07     NA      NA     NA      NA    NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Doel1_header</span> <span class="op">&lt;-</span> <span class="fu">read_fh</span><span class="op">(</span><span class="va">Doel1</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Doel1_header</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     series data_type         chrono_members species first last length n_sapwood</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   K1_091    Single                   &lt;NA&gt;    QUSP  1158 1292    135        15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   S38-BB    Single                   &lt;NA&gt;    QUSP  1193 1306    114         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  GD3-1BB    Single                   &lt;NA&gt;    QUSP  1222 1310     89         5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   GR1mBB    Quadro K1_001,K1_004x,GR1-3BB    QUSP  1220 1310     91         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   GQ1mBB    Quadro  GQ1-2BB,K1_007,K1_009    QUSP  1150 1314    165         7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   K1_095    Single                   &lt;NA&gt;    QUSP  1207 1320    114        21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  GG1-1BB    Single                   &lt;NA&gt;    QUSP  1240 1322     83        13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   S13mSB    Quadro          S1-3SB,K1_076    QUSP  1164 1322    159        20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  S13A-BB    Single                   &lt;NA&gt;    QUSP  1232 1324     93        19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   S6-SB    Single                   &lt;NA&gt;    QUSP  1221 1324    104        14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    n_sapwood_chr unmeasured_rings invalid_rings status waneyedge bark pith</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           &lt;NA&gt;               NA            NA  Dated      &lt;NA&gt; &lt;NA&gt;    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           &lt;NA&gt;               NA            NA  Dated      &lt;NA&gt; &lt;NA&gt;    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           &lt;NA&gt;               NA            NA  Dated      &lt;NA&gt; &lt;NA&gt;    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           &lt;NA&gt;               NA            NA  Dated       ---    -    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           &lt;NA&gt;               NA            NA  Dated       ---    -    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           &lt;NA&gt;               NA            NA  Dated      &lt;NA&gt;    -    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7           &lt;NA&gt;               NA            NA  Dated      &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8           &lt;NA&gt;               NA            NA  Dated       --- &lt;NA&gt;    -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9           &lt;NA&gt;               NA             1  Dated       WKE &lt;NA&gt; &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10          &lt;NA&gt;               NA             1  Dated       WKE &lt;NA&gt; &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    pith_offset pith_offset_delta                                  comments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           NA                NA                                 keelplank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           NA                NA  HW/SW boundary | K1_281 | framing timber</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           NA                NA                       K1_370 | hull plank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           NA                NA                                hull plank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           NA                NA                                hull plank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           NA                NA                                inner stem</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7           NA                NA                                hull plank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8           NA                NA average of S1-3SB,K1_076 | framing timber</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9           NA                NA                            framing timber</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10          NA                NA                            framing timber</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                project                location town  zip       street</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  Ship timbers DOEL 1       Doel_Deurganckdok &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  Ship timbers DOEL 1       Doel_Deurganckdok &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  Ship timbers DOEL 1       Doel_Deurganckdok &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  Ship timbers DOEL 1       Doel_Deurganckdok Doel &lt;NA&gt; Deurganckdok</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Ship timbers DOEL 1       Doel_Deurganckdok Doel &lt;NA&gt; Deurganckdok</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  Ship timbers DOEL 1       Doel_Deurganckdok Doel &lt;NA&gt; Deurganckdok</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7                 &lt;NA&gt; KOGGE ANTWERPEN GG1-1BB &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  Ship timbers DOEL 1       Doel_Deurganckdok &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  Ship timbers DOEL 1       Doel_Deurganckdok &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10                &lt;NA&gt;   KOGGE ANTWERPEN S6-SB &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    sampling_date measuring_date personal_id client_id longitude  latitude</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           &lt;NA&gt;           &lt;NA&gt;          KH      &lt;NA&gt;  4.269711 51.298236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           &lt;NA&gt;           &lt;NA&gt;          KH      &lt;NA&gt;  4.269711 51.298236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           &lt;NA&gt;           &lt;NA&gt;          KH      &lt;NA&gt;  4.269711 51.298236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           &lt;NA&gt;           &lt;NA&gt;          KH      &lt;NA&gt;  4.269711 51.298236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           &lt;NA&gt;           &lt;NA&gt;          KH      &lt;NA&gt;  4.269711 51.298236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           &lt;NA&gt;           &lt;NA&gt;          KH      &lt;NA&gt;  4.269711 51.298236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7           &lt;NA&gt;           &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;  4.269711 51.298236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8           &lt;NA&gt;           &lt;NA&gt;          KH      &lt;NA&gt;  4.269711 51.298236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9           &lt;NA&gt;           &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;  4.269711 51.298236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10          &lt;NA&gt;           &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;  4.269711 51.298236</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristof Haneca.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

