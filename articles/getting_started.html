<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="fellingdater">
<title>Get started • fellingdater</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get started">
<meta property="og:description" content="fellingdater">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fellingdater</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9004</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/getting_started.html">Get started</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/hanecakr/fellingdater/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Get started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/hanecakr/fellingdater/blob/HEAD/vignettes/getting_started.Rmd" class="external-link"><code>vignettes/getting_started.Rmd</code></a></small>
      <div class="d-none name"><code>getting_started.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="fellingdater-estimate-report-and-combine-felling-dates-of-historical-tree-ring-series">
<code>fellingdater</code>: Estimate, report and combine felling
dates of historical tree-ring series<a class="anchor" aria-label="anchor" href="#fellingdater-estimate-report-and-combine-felling-dates-of-historical-tree-ring-series"></a>
</h2>
<p>This R-package offers a suite of functions designed to assist you in
inferring estimates for felling dates from dated tree-ring series. The
presence of (partially) preserved sapwood or waney edge allows on a
(pre-)historical timber allows to estimate the missing number of sapwood
rings. from this estimate, a range for the actual felling date can be
determined and reported, for individual series as well as for a group of
related timbers.</p>
<p>In cases where it can be assumed that a group of historical timbers
were all felled simultaneously (i.e., in the same year), but due to the
absence of the bark/cambial zone (waney edge) and the final formed tree
ring, this cannot be determined, the preserved sapwood rings can be used
to establish a date range for the felling event.</p>
<p>Taking into account the observed number of sapwood rings across all
analysed samples and combining them into a single estimate, a more
accurate and precise estimation of the felling date year for the group
of timbers under study is likely to be obtained.</p>
<p>This vignette provides a quick overview of the package main
functions, including a new tool to sum sapwood probability
distributions, comparable to ‘summed probability densities (SPD)’
commonly applied to sets of radiocarbon (<sup>14</sup>C) dates.</p>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>You can install the development version of fellingdater from <a href="https://github.com/hanecakr/fellingdater/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"hanecakr/fellingdater"</span><span class="op">)</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"hanecakr/fellingdater"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="basic-example">Basic example<a class="anchor" aria-label="anchor" href="#basic-example"></a>
</h3>
<p>In the following example the combined felling date range for a set of
five dated tree-ring series is computed:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hanecakr/fellingdater" class="external-link">fellingdater</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## a data set where all series have partially preserved sapwood:</span></span>
<span><span class="fu"><a href="../reference/sw_combine.html">sw_combine</a></span><span class="op">(</span><span class="va">trs_example1</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting_started_files/figure-html/example-1.png" width="700"></p>
<p>The light grey distributions represent the probability density
function of the felling date range for each individual series. The dark
grey distribution is the combined estimate for a common felling
date.</p>
<p>The sapwood data used in the example above to estimate the felling
date range, was published by <a href="https://search.worldcat.org/nl/title/6391864" class="external-link">Hollstein (1980)</a>
:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sw_model.html">sw_model</a></span><span class="op">(</span><span class="st">"Hollstein_1980"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting_started_files/figure-html/model_sapwood_counts-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="main-functions">Main functions<a class="anchor" aria-label="anchor" href="#main-functions"></a>
</h3>
<div class="section level4">
<h4 id="sw_interval">sw_interval<a class="anchor" aria-label="anchor" href="#sw_interval"></a>
</h4>
<p>This function calculates the probability density function (PDF) and
the highest probability density interval (HDI) for the range of
potential felling dates, based on the observed number of sapwood rings,
their chronological dating and the selected sapwood data and model.</p>
<p>In the example below, we observe 10 sapwood rings on a sample (with
the last ring dated to 1234 AD) that originates from the Southern Baltic
region. The sapwood model published by <a href="https://www.academia.edu/3486096/Aufbau_und_Anwendung_der_Dendrochronologie_f%C3%BCr_Eichenholz_in_Polen" class="external-link">Wazny,
1990</a> covers this provenance region. The hdi delineates an interval
in which the actual felling date is most likely situated. It represents
the shortest interval within a probability distribution for a given
probability mass or credible interval. The HDI summarizes the
distribution by specifying an interval that spans most of the
distribution, typically 95%, such that every point inside the interval
has higher credibility than any point outside the interval.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sw_interval.html">sw_interval</a></span><span class="op">(</span>n_sapwood <span class="op">=</span> <span class="fl">10</span>,</span>
<span>            last <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>            hdi <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            cred_mass <span class="op">=</span> <span class="fl">.95</span>, </span>
<span>            sw_data <span class="op">=</span> <span class="st">"Wazny_1990"</span>, </span>
<span>            densfun <span class="op">=</span> <span class="st">"lognormal"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   lower upper         p</span></span>
<span><span class="co">#&gt; 1  1234  1250 0.9611793</span></span></code></pre></div>
<p>When <code>hdi = FALSE</code>, a matrix is returned with scaled
<em>p</em>-values for each number of observed sapwood rings.</p>
<p>The results of this procedure can be visualized by setting
<code>plot = TRUE</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 10 sapwood rings observed and the Wazny 1990 sapwood model:</span></span>
<span><span class="fu"><a href="../reference/sw_interval.html">sw_interval</a></span><span class="op">(</span>n_sapwood <span class="op">=</span> <span class="fl">10</span>,</span>
<span>            last <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>            hdi <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            cred_mass <span class="op">=</span> <span class="fl">.95</span>, </span>
<span>            sw_data <span class="op">=</span> <span class="st">"Wazny_1990"</span>, </span>
<span>            densfun <span class="op">=</span> <span class="st">"lognormal"</span>,</span>
<span>            plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="fd_report">fd_report<a class="anchor" aria-label="anchor" href="#fd_report"></a>
</h4>
<p>The <code><a href="../reference/fd_report.html">fd_report()</a></code>function reports estimates of the felling
date (fd) range for individual series.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"aaa"</span>, <span class="st">"bbb"</span>, <span class="st">"ccc"</span><span class="op">)</span>,</span>
<span>                 swr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>                 waneyedge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">FALSE</span>,<span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                 end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">123</span>, <span class="fl">456</span>, <span class="fl">1789</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/fd_report.html">fd_report</a></span><span class="op">(</span><span class="va">tmp</span>,</span>
<span>         series <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>         n_sapwood <span class="op">=</span> <span class="st">"swr"</span>,</span>
<span>         last <span class="op">=</span> <span class="st">"end"</span>,</span>
<span>         sw_data <span class="op">=</span> <span class="st">"Wazny_1990"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   series last n_sapwood waneyedge lower upper        felling_date sapwood_model</span></span>
<span><span class="co">#&gt; 1    aaa  123        10     FALSE   123   139 between 123 and 139    Wazny_1990</span></span>
<span><span class="co">#&gt; 2    bbb  456        11     FALSE   456   471 between 456 and 471    Wazny_1990</span></span>
<span><span class="co">#&gt; 3    ccc 1789        12      TRUE    NA  1789             in 1789    Wazny_1990</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sw_combine">sw_combine<a class="anchor" aria-label="anchor" href="#sw_combine"></a>
</h4>
<p>The the <code><a href="../reference/sw_combine.html">sw_combine()</a></code> function combines felling dates of
a group of related series with (partially) preserved sapwood, in order
to narrow down the range of a common felling date. The function returns
a list with:</p>
<ul>
<li><p>the PDF for the felling date of the individual series and the PDF
of the model that combines these individual series
(<code>$dataRaw</code>),</p></li>
<li><p>the HDI for the combined estimate of the common felling date
(<code>$hdi_model</code>),</p></li>
<li><p>the <em>Agreement index</em> (<code>$A_comb</code>) of the model,
expressing how well the individual series fit into the model (ideally
around 100%, and not lower than the critical threshold A_c = 60%)
,</p></li>
<li><p>an overview of the felling date range for the individual series
(<code>$individual_series</code>), and their <em>Agreement index</em>
(A_i) to the combined model.</p></li>
</ul>
<div class="section level5">
<h5 id="trs_example0">trs_example0<a class="anchor" aria-label="anchor" href="#trs_example0"></a>
</h5>
<p>A data set with dated tree-ring series, all with partially preserved
sapwood. The names of the variables in the data set are mapped to the
parameters of the <code><a href="../reference/sw_combine.html">sw_combine()</a></code> function. In the example
below, the numeric output is returned:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trs_example0</span></span>
<span><span class="co">#&gt;      trs  end swr  bark</span></span>
<span><span class="co">#&gt; 1 trs_01 1000   5 FALSE</span></span>
<span><span class="co">#&gt; 2 trs_02 1009  10 FALSE</span></span>
<span><span class="co">#&gt; 3 trs_03 1007  15 FALSE</span></span>
<span><span class="co">#&gt; 4 trs_04 1005  16 FALSE</span></span>
<span><span class="co">#&gt; 5 trs_05 1010   8 FALSE</span></span>
<span><span class="co"># In trs_example0, the column names are not equivalent to the default names in `sw_combine()`.</span></span>
<span></span>
<span><span class="va">output_comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sw_combine.html">sw_combine</a></span><span class="op">(</span><span class="va">trs_example0</span>,</span>
<span>   series <span class="op">=</span> <span class="st">"trs"</span>,</span>
<span>   last <span class="op">=</span> <span class="st">"end"</span>,</span>
<span>   n_sapwood <span class="op">=</span> <span class="st">"swr"</span>,</span>
<span>   waneyedge <span class="op">=</span> <span class="st">"bark"</span>,</span>
<span>   cred_mass <span class="op">=</span> <span class="fl">.954</span>,</span>
<span>   plot <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">output_comb</span><span class="op">$</span><span class="va">rawData</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="va">output_comb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt; $sapwood_data</span></span>
<span><span class="co">#&gt; [1] "Hollstein_1980"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sapwood_model</span></span>
<span><span class="co">#&gt; [1] "lognormal"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cred_mass</span></span>
<span><span class="co">#&gt; [1] 0.954</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $hdi_model</span></span>
<span><span class="co">#&gt;   lower upper         p</span></span>
<span><span class="co">#&gt; 1     6    34 0.9561277</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $hdi_combine</span></span>
<span><span class="co">#&gt;   lower upper         p</span></span>
<span><span class="co">#&gt; 1  1010  1018 0.9741642</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $individual_series</span></span>
<span><span class="co">#&gt;   series last n_sapwood waneyedge lower upper agr_index</span></span>
<span><span class="co">#&gt; 1 trs_01 1000         5     FALSE  1001  1029     122.0</span></span>
<span><span class="co">#&gt; 2 trs_02 1009        10     FALSE  1009  1033     132.3</span></span>
<span><span class="co">#&gt; 3 trs_03 1007        15     FALSE  1007  1029     103.9</span></span>
<span><span class="co">#&gt; 4 trs_04 1005        16     FALSE  1005  1026      78.9</span></span>
<span><span class="co">#&gt; 5 trs_05 1010         8     FALSE  1010  1036     108.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $A_model</span></span>
<span><span class="co">#&gt; Overall agreement index (%) </span></span>
<span><span class="co">#&gt;                       117.6 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $A_c</span></span>
<span><span class="co">#&gt; Critical threshold (%) </span></span>
<span><span class="co">#&gt;                     60 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $model_summary</span></span>
<span><span class="co">#&gt; [1] "felling date range:  1010  -  1018"</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="trs_example2">trs_example2<a class="anchor" aria-label="anchor" href="#trs_example2"></a>
</h5>
<p>A data set with 5 tree-ring series, one of which has an exact felling
date (waney edge present):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trs_example2</span></span>
<span><span class="co">#&gt;   series last n_sapwood waneyedge</span></span>
<span><span class="co">#&gt; 1 trs_06 1000         5     FALSE</span></span>
<span><span class="co">#&gt; 2 trs_07 1005        10     FALSE</span></span>
<span><span class="co">#&gt; 3 trs_08 1008        NA     FALSE</span></span>
<span><span class="co">#&gt; 4 trs_09 1000         1     FALSE</span></span>
<span><span class="co">#&gt; 5 trs_10 1010        15      TRUE</span></span>
<span></span>
<span><span class="fu"><a href="../reference/sw_combine.html">sw_combine</a></span><span class="op">(</span><span class="va">trs_example2</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="trs_example3">trs_example3<a class="anchor" aria-label="anchor" href="#trs_example3"></a>
</h5>
<p>A data set where all tree-ring series have been measured up to the
waney edge:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sw_combine.html">sw_combine</a></span><span class="op">(</span><span class="va">trs_example3</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="trs_example4">trs_example4<a class="anchor" aria-label="anchor" href="#trs_example4"></a>
</h5>
<p>An attempt to compute a common felling date for a group of tree-ring
series, all including partially preserved sapwood:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sw_combine.html">sw_combine</a></span><span class="op">(</span><span class="va">trs_example4</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>No common felling date can be computed for this particular data set.
The model fails (agreement index of the model is below the critical
threshold value (A_c) of 60%). Three series have an individual agreement
index below 60%.</p>
</div>
<div class="section level5">
<h5 id="trs_example5">trs_example5<a class="anchor" aria-label="anchor" href="#trs_example5"></a>
</h5>
<p>When no sapwood rings are observed and measured, only an
<code>earliest possible felling date</code> (<em>terminus post
quem</em>) can be determined:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sw_combine.html">sw_combine</a></span><span class="op">(</span><span class="va">trs_example5</span>,  plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
</div>
<div class="section level4">
<h4 id="sw_sum">sw_sum<a class="anchor" aria-label="anchor" href="#sw_sum"></a>
</h4>
<p>The <code><a href="../reference/sw_sum.html">sw_sum()</a></code> function calculates the the summed
probability density (SPD) for a set of felling date ranges. In the
example, the SPD for a set of 9 series with partially preserved sapwood
or waney edge is computed and plotted. A smoother for the SPD is plotted
as well. The dots represent exact felling dates (i.e., series with waney
edge).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spd7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sw_sum.html">sw_sum</a></span><span class="op">(</span><span class="va">trs_example7</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in sw_sum(trs_example7, plot = FALSE): --&gt; 1 series without sapwood rings or waney edge detected</span></span>
<span><span class="co">#&gt;         and removed from the data set</span></span>
<span><span class="fu"><a href="../reference/sw_sum_plot.html">sw_sum_plot</a></span><span class="op">(</span><span class="va">spd7</span>, window_smooth <span class="op">=</span> <span class="fl">5</span>, bar_col <span class="op">=</span> <span class="st">"#95d5b2"</span>, trend_col <span class="op">=</span> <span class="st">"#dda15e"</span>, dot_col <span class="op">=</span> <span class="st">"forestgreen"</span>, dot_shape <span class="op">=</span> <span class="fl">23</span>, dot_size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="helper-functions">Helper functions<a class="anchor" aria-label="anchor" href="#helper-functions"></a>
</h3>
<div class="section level4">
<h4 id="sw_data_overview">sw_data_overview<a class="anchor" aria-label="anchor" href="#sw_data_overview"></a>
</h4>
<p>The function <code><a href="../reference/sw_data_overview.html">sw_data_overview()</a></code> provides an overview of
all published sapwood data sets distributed with this package.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sw_data_overview.html">sw_data_overview</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Brathen_1982"     "Hollstein_1980"   "Miles_1997_NM"    "Miles_1997_SC"   </span></span>
<span><span class="co">#&gt;  [5] "Miles_1997_WBC"   "Pilcher_1987"     "Sohar_2012_ELL_c" "Sohar_2012_ELL_t"</span></span>
<span><span class="co">#&gt;  [9] "Sohar_2012_FWE_c" "Sohar_2012_FWE_t" "Wazny_1990"       "vanDaalen_NLBE"  </span></span>
<span><span class="co">#&gt; [13] "vanDaalen_Norway"</span></span></code></pre></div>
<p>Load the original data with, for example,
<code>get("Hollstein_1980")</code>.</p>
</div>
<div class="section level4">
<h4 id="sw_data_info">sw_data_info<a class="anchor" aria-label="anchor" href="#sw_data_info"></a>
</h4>
<p>More information on one of the sapwood data sets - how to cite the
data set, the geographical area the data represents, the number of
observations and some basic summary stats - can be retrieved by using
the <code><a href="../reference/sw_data_info.html">sw_data_info()</a></code> function.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sw_data_info.html">sw_data_info</a></span><span class="op">(</span><span class="st">"Pilcher_1987"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; [1] "Pilcher_1987"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $citation</span></span>
<span><span class="co">#&gt; [1] "Pilcher J.R. 1987. A 700 year dating chronology for northern France. Applications of tree-ring studies. Current research in dendrochronology and related subjects. BAR International Series 333, 127–139."</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $area</span></span>
<span><span class="co">#&gt; [1] "Northern France"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_observations</span></span>
<span><span class="co">#&gt; [1] 116</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $summary_raw_data</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;   12.00   22.00   26.00   26.72   31.00   49.00</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sw_model-and-sw_model_plot">sw_model and sw_model_plot()<a class="anchor" aria-label="anchor" href="#sw_model-and-sw_model_plot"></a>
</h4>
<p>A graphical representation of a sapwood data set is provided by the
<code><a href="../reference/sw_model_plot.html">sw_model_plot()</a></code> function.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sw_model.html">sw_model</a></span><span class="op">(</span>sw_data <span class="op">=</span> <span class="st">"Sohar_2012_ELL_c"</span>, </span>
<span>                densfun <span class="op">=</span> <span class="st">"lognormal"</span>,</span>
<span>                cred_mass <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>                plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/sw_model_plot.html">sw_model_plot</a></span><span class="op">(</span><span class="va">tmp</span>, </span>
<span>              bar_fill <span class="op">=</span> <span class="st">"steelblue3"</span>,</span>
<span>              bar_color <span class="op">=</span> <span class="st">"grey60"</span>,</span>
<span>              line_color <span class="op">=</span> <span class="st">"red3"</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting_started_files/figure-html/model-1.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/sw_data_info.html">sw_data_info</a></span><span class="op">(</span><span class="st">"Sohar_2012_ELL_c"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; [1] "Sohar_2012_ELL_c"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $citation</span></span>
<span><span class="co">#&gt; [1] "Sohar K., Vitas A. &amp; Läänelaid A. 2012. Sapwood estimates of pedunculate oak (Quercus robur L.) in eastern Baltic, Dendrochronologia 30.1, 49–56. DOI: https://doi.org/10.1016/j.dendro.2011.08.001"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $area</span></span>
<span><span class="co">#&gt; [1] "Eastern Estonia, Latvia, Lithuania (sapwood determined by color)."</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_observations</span></span>
<span><span class="co">#&gt; [1] 562</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $summary_raw_data</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;    2.00   10.00   12.00   11.69   13.00   27.00</span></span></code></pre></div>
<p>The <code><a href="../reference/sw_model.html">sw_model()</a></code> function fits a distribution to a data
set of observed sapwood numbers and computes the highest posterior
density interval (HDI) for a given credibility mass. The density
function fitted to the sapwood data set should be one of:</p>
<ul>
<li>“lognormal” (the default value),</li>
<li>“normal”,</li>
<li>“weibull”,</li>
<li>“gamma”.</li>
</ul>
<p>The credible interval should be a value between 0 and 1.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sw_model.html">sw_model</a></span><span class="op">(</span><span class="st">"Wazny_1990"</span>, densfun <span class="op">=</span> <span class="st">"gamma"</span>, cred_mass<span class="op">=</span> <span class="fl">.90</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in densfun(x, parm[1], parm[2], ...): NaNs produced</span></span></code></pre></div>
<p><img src="getting_started_files/figure-html/sw_model_plot2-1.png" width="700"></p>
<p>When <code>plot = FALSE</code>, a list with the numeric output of the
modelling process is returned.</p>
</div>
<div class="section level4">
<h4 id="read_fh-and-get_header">read_fh and get_header<a class="anchor" aria-label="anchor" href="#read_fh-and-get_header"></a>
</h4>
<p>The <code><a href="../reference/read_fh.html">read_fh()</a></code> function is an extension to the
<code><a href="https://rdrr.io/pkg/dplR/man/read.fh.html" class="external-link">dplR::read.fh()</a></code> function from the <a href="https://github.com/AndyBunn/dplR" class="external-link"><strong>dplR
package</strong></a> (<a href="https://doi.org/10.1016/j.dendro.2008.01.002" class="external-link">Bunn 2008</a>, <a href="https://doi.org/10.1016/j.dendro.2009.12.001" class="external-link">Bunn 2010</a>, <a href="https://github.com/AndyBunn/dplR" class="external-link">Bunn <em>et al.</em> 2022</a>).
It allows to read .fh (format Heidelberg) files of ring widths AND
additional information found in the HEADER fields are listed as
attributes.</p>
<p>This function also works with ring-width data in CHRONO and
HALF-CHRONO format.</p>
<p>Furthermore, the <code><a href="../reference/read_fh.html">read_fh()</a></code> function is case
insensitive.</p>
<p>In the example below, an .fh file with dated tree-ring series from a
medieval ship DOEL1 is read with <code><a href="../reference/read_fh.html">read_fh()</a></code>. The ring width
measurement, in different formats, are converted to a
<code>data.frame</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Doel1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"DOEL1.fh"</span>, package <span class="op">=</span> <span class="st">"fellingdater"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Doel1_trs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_fh.html">read_fh</a></span><span class="op">(</span><span class="va">Doel1</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Doel1_trs</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="co">#&gt;      K1_091 S38-BB GD3-1BB GR1mBB GQ1mBB K1_095 GG1-1BB S13mSB S13A-BB S6-SB</span></span>
<span><span class="co">#&gt; 1150     NA     NA      NA     NA   3.80     NA      NA     NA      NA    NA</span></span>
<span><span class="co">#&gt; 1151     NA     NA      NA     NA   4.15     NA      NA     NA      NA    NA</span></span>
<span><span class="co">#&gt; 1152     NA     NA      NA     NA   4.63     NA      NA     NA      NA    NA</span></span>
<span><span class="co">#&gt; 1153     NA     NA      NA     NA   4.31     NA      NA     NA      NA    NA</span></span>
<span><span class="co">#&gt; 1154     NA     NA      NA     NA   3.97     NA      NA     NA      NA    NA</span></span>
<span><span class="co">#&gt; 1155     NA     NA      NA     NA   4.10     NA      NA     NA      NA    NA</span></span>
<span><span class="co">#&gt; 1156     NA     NA      NA     NA   2.02     NA      NA     NA      NA    NA</span></span>
<span><span class="co">#&gt; 1157     NA     NA      NA     NA   3.24     NA      NA     NA      NA    NA</span></span>
<span><span class="co">#&gt; 1158   2.50     NA      NA     NA   3.75     NA      NA     NA      NA    NA</span></span>
<span><span class="co">#&gt; 1159   2.73     NA      NA     NA   3.07     NA      NA     NA      NA    NA</span></span>
<span><span class="co">#&gt; 1160   2.27     NA      NA     NA   4.19     NA      NA     NA      NA    NA</span></span>
<span><span class="co">#&gt; 1161   1.44     NA      NA     NA   3.74     NA      NA     NA      NA    NA</span></span>
<span><span class="co">#&gt; 1162   1.47     NA      NA     NA   4.54     NA      NA     NA      NA    NA</span></span>
<span><span class="co">#&gt; 1163   2.29     NA      NA     NA   4.61     NA      NA     NA      NA    NA</span></span>
<span><span class="co">#&gt; 1164   2.83     NA      NA     NA   3.91     NA      NA   1.84      NA    NA</span></span></code></pre></div>
<p>When <code>header = TRUE</code>, the <code>get_header()</code>
function is triggered and HEADER fields in the .fh file are returned as
a <code>data.frame</code>, instead of the ring-width measurements.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/read_fh.html">read_fh</a></span><span class="op">(</span><span class="va">Doel1</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;     series data_type         chrono_members species first last length n_sapwood</span></span>
<span><span class="co">#&gt; 1   K1_091    Single                   &lt;NA&gt;    QUSP  1158 1292    135        15</span></span>
<span><span class="co">#&gt; 2   S38-BB    Single                   &lt;NA&gt;    QUSP  1193 1306    114         0</span></span>
<span><span class="co">#&gt; 3  GD3-1BB    Single                   &lt;NA&gt;    QUSP  1222 1310     89         5</span></span>
<span><span class="co">#&gt; 4   GR1mBB    Quadro K1_001,K1_004x,GR1-3BB    QUSP  1220 1310     91         3</span></span>
<span><span class="co">#&gt; 5   GQ1mBB    Quadro  GQ1-2BB,K1_007,K1_009    QUSP  1150 1314    165         7</span></span>
<span><span class="co">#&gt; 6   K1_095    Single                   &lt;NA&gt;    QUSP  1207 1320    114        21</span></span>
<span><span class="co">#&gt; 7  GG1-1BB    Single                   &lt;NA&gt;    QUSP  1240 1322     83        13</span></span>
<span><span class="co">#&gt; 8   S13mSB    Quadro          S1-3SB,K1_076    QUSP  1164 1322    159        20</span></span>
<span><span class="co">#&gt; 9  S13A-BB    Single                   &lt;NA&gt;    QUSP  1232 1324     93        19</span></span>
<span><span class="co">#&gt; 10   S6-SB    Single                   &lt;NA&gt;    QUSP  1221 1324    104        14</span></span>
<span><span class="co">#&gt;    n_sapwood_chr unmeasured_rings invalid_rings status waneyedge bark pith</span></span>
<span><span class="co">#&gt; 1           &lt;NA&gt;               NA            NA  Dated      &lt;NA&gt; &lt;NA&gt;    -</span></span>
<span><span class="co">#&gt; 2           &lt;NA&gt;               NA            NA  Dated      &lt;NA&gt; &lt;NA&gt;    -</span></span>
<span><span class="co">#&gt; 3           &lt;NA&gt;               NA            NA  Dated      &lt;NA&gt; &lt;NA&gt;    -</span></span>
<span><span class="co">#&gt; 4           &lt;NA&gt;               NA            NA  Dated       ---    -    -</span></span>
<span><span class="co">#&gt; 5           &lt;NA&gt;               NA            NA  Dated       ---    -    -</span></span>
<span><span class="co">#&gt; 6           &lt;NA&gt;               NA            NA  Dated      &lt;NA&gt;    -    -</span></span>
<span><span class="co">#&gt; 7           &lt;NA&gt;               NA            NA  Dated      &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 8           &lt;NA&gt;               NA            NA  Dated       --- &lt;NA&gt;    -</span></span>
<span><span class="co">#&gt; 9           &lt;NA&gt;               NA             1  Dated       WKE &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 10          &lt;NA&gt;               NA             1  Dated       WKE &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    pith_offset pith_offset_delta                                  comments</span></span>
<span><span class="co">#&gt; 1           NA                NA                                 keelplank</span></span>
<span><span class="co">#&gt; 2           NA                NA  HW/SW boundary | K1_281 | framing timber</span></span>
<span><span class="co">#&gt; 3           NA                NA                       K1_370 | hull plank</span></span>
<span><span class="co">#&gt; 4           NA                NA                                hull plank</span></span>
<span><span class="co">#&gt; 5           NA                NA                                hull plank</span></span>
<span><span class="co">#&gt; 6           NA                NA                                inner stem</span></span>
<span><span class="co">#&gt; 7           NA                NA                                hull plank</span></span>
<span><span class="co">#&gt; 8           NA                NA average of S1-3SB,K1_076 | framing timber</span></span>
<span><span class="co">#&gt; 9           NA                NA                            framing timber</span></span>
<span><span class="co">#&gt; 10          NA                NA                            framing timber</span></span>
<span><span class="co">#&gt;                project                location town  zip       street</span></span>
<span><span class="co">#&gt; 1  Ship timbers DOEL 1       Doel_Deurganckdok &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2  Ship timbers DOEL 1       Doel_Deurganckdok &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3  Ship timbers DOEL 1       Doel_Deurganckdok &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4  Ship timbers DOEL 1       Doel_Deurganckdok Doel &lt;NA&gt; Deurganckdok</span></span>
<span><span class="co">#&gt; 5  Ship timbers DOEL 1       Doel_Deurganckdok Doel &lt;NA&gt; Deurganckdok</span></span>
<span><span class="co">#&gt; 6  Ship timbers DOEL 1       Doel_Deurganckdok Doel &lt;NA&gt; Deurganckdok</span></span>
<span><span class="co">#&gt; 7                 &lt;NA&gt; KOGGE ANTWERPEN GG1-1BB &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 8  Ship timbers DOEL 1       Doel_Deurganckdok &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 9  Ship timbers DOEL 1       Doel_Deurganckdok &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 10                &lt;NA&gt;   KOGGE ANTWERPEN S6-SB &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    sampling_date measuring_date personal_id client_id longitude  latitude</span></span>
<span><span class="co">#&gt; 1           &lt;NA&gt;           &lt;NA&gt;          KH      &lt;NA&gt;  4.269711 51.298236</span></span>
<span><span class="co">#&gt; 2           &lt;NA&gt;           &lt;NA&gt;          KH      &lt;NA&gt;  4.269711 51.298236</span></span>
<span><span class="co">#&gt; 3           &lt;NA&gt;           &lt;NA&gt;          KH      &lt;NA&gt;  4.269711 51.298236</span></span>
<span><span class="co">#&gt; 4           &lt;NA&gt;           &lt;NA&gt;          KH      &lt;NA&gt;  4.269711 51.298236</span></span>
<span><span class="co">#&gt; 5           &lt;NA&gt;           &lt;NA&gt;          KH      &lt;NA&gt;  4.269711 51.298236</span></span>
<span><span class="co">#&gt; 6           &lt;NA&gt;           &lt;NA&gt;          KH      &lt;NA&gt;  4.269711 51.298236</span></span>
<span><span class="co">#&gt; 7           &lt;NA&gt;           &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;  4.269711 51.298236</span></span>
<span><span class="co">#&gt; 8           &lt;NA&gt;           &lt;NA&gt;          KH      &lt;NA&gt;  4.269711 51.298236</span></span>
<span><span class="co">#&gt; 9           &lt;NA&gt;           &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;  4.269711 51.298236</span></span>
<span><span class="co">#&gt; 10          &lt;NA&gt;           &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;  4.269711 51.298236</span></span></code></pre></div>
<p>The <code>data.frame</code> with the HEADER fields can then be used
as input for the sw_functions:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Doel1_header</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_fh.html">read_fh</a></span><span class="op">(</span><span class="va">Doel1</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Doel1_header</span> <span class="op">|&gt;</span> </span>
<span>   <span class="co"># first convert column 'waneyedge' to a logical vector </span></span>
<span>   <span class="co"># (in the original .fh file header fields the presence of waney edge is</span></span>
<span>   <span class="co"># indicated by "WK" - a character string - in the corresponding HEADER field)</span></span>
<span>   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>waneyedge <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"wk"</span>, <span class="va">waneyedge</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                               <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span>   <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu"><a href="../reference/sw_combine.html">sw_combine</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>The attempt to combine the dated tree-ring series from DOEL1 into a
single felling-date range fails. These tree-ring series cannot represent
a single event.</p>
<p>However, leaving out the tree-ring series of the keelplank (series
“K1_091”) of this medieval ship shows that the hull planking and some
frame elements could share a common felling date:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Doel1_header</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>waneyedge <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"wk"</span>, <span class="va">waneyedge</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                               <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span>   <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">series</span> <span class="op">!=</span> <span class="st">"K1_091"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu"><a href="../reference/sw_combine.html">sw_combine</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>For more details see: <a href="https://doi.org/10.1111/1095-9270.12037" class="external-link">Haneca &amp; Daly
(2014)</a></p>
</div>
<div class="section level4">
<h4 id="cor_table">cor_table<a class="anchor" aria-label="anchor" href="#cor_table"></a>
</h4>
<p>The <code><a href="../reference/cor_table.html">cor_table()</a></code> function computes common correlation
values between dated tree-ring series (x) and a set of reference
chronologies (y). This function assists in checking the end date of the
series against absolutely dated reference chronologies, but also to
select the most appropriate sapwood model for your data according to the
provenance of the wood (by running it against chronologies that
represent a geographically confined region).</p>
<p>The correlation values computed are:</p>
<ul>
<li><p>glk: ‘Gleichläufigkeit’ or ‘percentage of parallel variation’ (<a href="https://doi.org/10.1016/j.dendro.2015.03.003" class="external-link">Buras &amp; Wilmking
2015</a>; <a href="https://doi.org/10.1007/BF02741777" class="external-link">Eckstein &amp;
Bauch 1969</a>; <a href="https://doi.org/10.1007/BF02603303" class="external-link">Huber
1943</a>; <a href="https://doi.org/10.1111/arcm.12600" class="external-link">Visser
2020</a>)</p></li>
<li><p>glk_p: significance level associated with the glk-value (<a href="https://dspace.library.uu.nl/handle/1874/45149" class="external-link">Jansma
1995</a>)</p></li>
<li><p>r_pearson: the Pearson’s correlation coefficient</p></li>
<li><p>t_St: Student’s t-value</p></li>
<li><p>t_BP: t-values according to the <a href="https://repository.arizona.edu/handle/10150/260029" class="external-link">Baillie &amp;
Pilcher (1973)</a> algorithm</p></li>
<li><p>t_Ho: t-values according to the <a href="https://search.worldcat.org/nl/title/6391864" class="external-link">Hollstein (1980)</a>
algorithm</p></li>
</ul>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Doel1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"DOEL1.fh"</span>, package <span class="op">=</span> <span class="st">"fellingdater"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Doel1_trs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_fh.html">read_fh</a></span><span class="op">(</span><span class="va">Doel1</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># crossdating ring-width series from Doel 1 against each other:</span></span>
<span><span class="va">cor_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cor_table.html">cor_table</a></span><span class="op">(</span><span class="va">Doel1_trs</span>, output <span class="op">=</span> <span class="st">"table"</span>, min_overlap <span class="op">=</span> <span class="fl">80</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cor_results</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt;     series length first last reference ref_first ref_last overlap  glk</span></span>
<span><span class="co">#&gt; 29 GD3-1BB     89  1222 1310    GQ1mBB      1150     1314      89 52.8</span></span>
<span><span class="co">#&gt; 73 GD3-1BB     89  1222 1310    S13mSB      1164     1322      89 48.9</span></span>
<span><span class="co">#&gt; 91 GD3-1BB     89  1222 1310     S6-SB      1221     1324      89 54.5</span></span>
<span><span class="co">#&gt; 58 GD3-1BB     89  1222 1310    K1_095      1207     1320      89 51.7</span></span>
<span><span class="co">#&gt; 31 GD3-1BB     89  1222 1310    GR1mBB      1220     1310      89 47.2</span></span>
<span><span class="co">#&gt; 87 GD3-1BB     89  1222 1310    S38-BB      1193     1306      85 54.2</span></span>
<span><span class="co">#&gt; 75 GG1-1BB     83  1240 1322    S13mSB      1164     1322      83 59.8</span></span>
<span><span class="co">#&gt; 69 GG1-1BB     83  1240 1322   S13A-BB      1232     1324      83 55.5</span></span>
<span><span class="co">#&gt; 59 GG1-1BB     83  1240 1322    K1_095      1207     1320      81 50.6</span></span>
<span><span class="co">#&gt; 98 GG1-1BB     83  1240 1322     S6-SB      1221     1324      83 47.0</span></span>
<span><span class="co">#&gt; 33  GQ1mBB    165  1150 1314    GR1mBB      1220     1310      91 76.7</span></span>
<span><span class="co">#&gt; 76  GQ1mBB    165  1150 1314    S13mSB      1164     1322     151 59.0</span></span>
<span><span class="co">#&gt; 60  GQ1mBB    165  1150 1314    K1_095      1207     1320     108 56.1</span></span>
<span><span class="co">#&gt; 47  GQ1mBB    165  1150 1314    K1_091      1158     1292     135 60.1</span></span>
<span><span class="co">#&gt; 62  GQ1mBB    165  1150 1314   S13A-BB      1232     1324      83 54.9</span></span>
<span><span class="co">#&gt; 89  GQ1mBB    165  1150 1314    S38-BB      1193     1306     114 49.6</span></span>
<span><span class="co">#&gt; 95  GQ1mBB    165  1150 1314     S6-SB      1221     1324      94 54.3</span></span>
<span><span class="co">#&gt; 77  GR1mBB     91  1220 1310    S13mSB      1164     1322      91 65.0</span></span>
<span><span class="co">#&gt; 51  GR1mBB     91  1220 1310    K1_095      1207     1320      91 60.0</span></span>
<span><span class="co">#&gt; 92  GR1mBB     91  1220 1310     S6-SB      1221     1324      90 55.6</span></span>
<span><span class="co">#&gt;           glk_p    r_pearson        t_St  t_BP  t_Ho</span></span>
<span><span class="co">#&gt; 29 5.919436e-01 -0.249779208 -2.40605037  2.11  2.74</span></span>
<span><span class="co">#&gt; 73 1.169772e+00  0.201284974  1.91669069  1.48  1.97</span></span>
<span><span class="co">#&gt; 91 3.910942e-01  0.035883266  0.33491251  2.16  1.92</span></span>
<span><span class="co">#&gt; 58 7.477459e-01  0.258187935  2.49273359  0.78  1.71</span></span>
<span><span class="co">#&gt; 31 1.408056e+00 -0.370271866 -3.71792327  0.78  1.18</span></span>
<span><span class="co">#&gt; 87 4.423117e-01  0.426532081  4.29630804  0.20  0.00</span></span>
<span><span class="co">#&gt; 75 7.546208e-02 -0.005084336 -0.04575962  2.28  2.93</span></span>
<span><span class="co">#&gt; 69 3.173465e-01  0.217882020  2.00920920  1.06  2.06</span></span>
<span><span class="co">#&gt; 59 9.104270e-01  0.597953189  6.63071551  0.09  1.07</span></span>
<span><span class="co">#&gt; 98 1.421457e+00 -0.137136419 -1.24599977  0.27  0.78</span></span>
<span><span class="co">#&gt; 33 3.624784e-07  0.727924641 10.01554116 12.23 10.41</span></span>
<span><span class="co">#&gt; 76 2.697516e-02  0.572471464  8.52261829  5.84  5.40</span></span>
<span><span class="co">#&gt; 60 2.067270e-01 -0.282768827 -3.03515368  3.52  3.02</span></span>
<span><span class="co">#&gt; 47 1.922538e-02  0.151940473  1.77284639  2.28  2.67</span></span>
<span><span class="co">#&gt; 62 3.740983e-01 -0.041724848 -0.37585094  2.19  2.48</span></span>
<span><span class="co">#&gt; 89 1.075278e+00 -0.178020527 -1.91457410  2.74  2.34</span></span>
<span><span class="co">#&gt; 95 4.042757e-01  0.078494804  0.75522595  1.09  1.16</span></span>
<span><span class="co">#&gt; 77 4.212192e-03  0.182334033  1.74946269  4.02  4.24</span></span>
<span><span class="co">#&gt; 51 5.640693e-02 -0.248806924 -2.42344980  3.38  3.50</span></span>
<span><span class="co">#&gt; 92 2.864524e-01  0.286284295  2.80290094  0.80  0.91</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kristof Haneca.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
