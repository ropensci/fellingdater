% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/trs_tbp.R
\name{trs_tbp}
\alias{trs_tbp}
\title{Compute Baillie & Pilcher-style t-values between all series in two rwl-style data frames}
\usage{
trs_tbp(x, y = NULL, min_overlap = 50, as_df = FALSE, transform = TRUE)
}
\arguments{
\item{x}{A data frame of test tree-ring series in \code{rwl} format (years as rownames,
series as columns). All columns must be numeric.}

\item{y}{A data frame of reference tree-ring series in \code{rwl} format. If \code{NULL},
uses \code{x} for self-comparison. Default is \code{NULL}.}

\item{min_overlap}{Integer. Minimum number of overlapping years required between
series pairs to compute t-values. Must be >= 3. Default is 50.}

\item{as_df}{Logical. If \code{TRUE}, returns results in long-format data frame.
If \code{FALSE}, returns list of matrices. Default is \code{FALSE}.}

\item{transform}{Logical. If \code{TRUE}, applies Baillie & Pilcher transformation
via \code{trs_tbp_transform()}. If \code{FALSE}, assumes input data is already transformed.
Default is \code{TRUE}.}
}
\value{
Depending on \code{as_df} parameter:
\itemize{
\item If \code{as_df = FALSE} (default): A list containing:
\itemize{
\item \code{t_BP}: Matrix of t-values with test series as rows, reference series as columns
\item \code{overlap}: Matrix of overlap counts (number of common years) with same dimensions
}
\item If \code{as_df = TRUE}: A data frame with columns:
\itemize{
\item \code{series}: Name of test series
\item \code{reference}: Name of reference series
\item \code{t_BP}: Baillie & Pilcher t-value
\item \code{overlap}: Number of overlapping years
}
}
}
\description{
This function computes crossdating t-statistics between all series in two datasets
using the Baillie & Pilcher (1973) method. Series are standardized using a 5-year
centered moving average and log-transformed before computing correlations and t-values.
}
\details{
The Baillie & Pilcher method involves:
\enumerate{
\item Alignment of series by common years
\item Application of 5-year centered moving average to each series
\item Log transformation: \eqn{\log(100 \times \text{value} / \text{moving average})}
\item Computation of Pearson correlation between transformed series
\item Calculation of t-statistic: \eqn{t = r \sqrt{(n-4-2)} / \sqrt{1-r^2}}
}

Where \eqn{n} is the number of overlapping observations and is adjusted by
subtracting 4 to account for degrees of freedom lost in the moving average.

Negative correlations are set to 0, and perfect correlations (|r| = 1) result
in infinite t-values.
}
\examples{
\dontrun{
# Create sample data
rwl_test <- trs_pseudo_rwl(n_series = 3, series_length = 100, end_date = 2020)
rwl_ref <- trs_pseudo_rwl(n_series = 2, series_length = 80, end_date = 2015)

# Compute t-values (matrix format)
result <- trs_tbp(rwl_test, rwl_ref, min_overlap = 30)
print(result$t_BP)
print(result$overlap)

# Compute t-values (data frame format)
result_df <- trs_tbp(rwl_test, rwl_ref, min_overlap = 30, as_df = TRUE)
print(result_df)

# Self-comparison within single dataset
self_comparison <- trs_tbp(rwl_test, min_overlap = 40)
}

}
\references{
Baillie, M.G.L. & Pilcher, J.R. (1973). A simple crossdating program for
tree-ring research. \emph{Tree-Ring Bulletin}, 33, 7â€“14.
}
\seealso{
\code{\link{trs_tbp_transform}} for the transformation function
}
